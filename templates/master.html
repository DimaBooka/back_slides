{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title></title>
</head>
<body>
  <link rel="stylesheet" href="{% static 'reveal.js/css/reveal.css' %}">
  <link rel="stylesheet" href="{% static 'reveal.js/css/theme/night.css' %}">
  <div class="reveal">
    <div class="slides">
      <section data-markdown="/media/{{slides}}"
         data-separator="^\n\n\n"
         data-separator-vertical="^\n\n">
      </section>
    </div>
  </div>
  <script src="{% static 'reveal.js/js/reveal.js' %}"></script>
  <script src="{% static 'reveal.js/lib/js/head.min.js' %}"></script>
  <script src="{% static 'reveal.js/plugin/markdown/marked.js' %}"></script>
  <script src="{% static 'reveal.js/plugin/markdown/markdown.js' %}"></script>
  <script src="{% static 'reveal.js/lib/js/classList.js' %}"></script>

  <script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
  <script>
    Reveal.initialize(
    {
      embedded: true,

      multiplex: {
        secret: '{{ secret }}',
        id: {{ id }},
        url: 'http://localhost:1948/'
      }
    });

    (function() {
      if ( window.location.search.match( /receiver/gi ) ) { return; }
      var multiplex = Reveal.getConfig().multiplex;
      var socket = io.connect( multiplex.url );
      function post() {
        var messageData = {
          state: Reveal.getState(),
          secret: multiplex.secret,
          socketId: multiplex.id
        };
        socket.emit( 'multiplex-statechanged', messageData );
      };
      var events = ['slidechanged', 'fragmentshown', 'fragmenthidden', 'overviewhidden', 'overviewshown', 'paused', 'resumed', ]
      events.forEach(function(item) {
        Reveal.addEventListener(item, post);
      });
    }());
  </script>
</body>
</html>